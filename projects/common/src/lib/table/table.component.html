<div class="flex flex-col">
  <div class="inline-flex flex-row items-center gap-1" *ngIf="showPageLimit">
    <span class="text-gray-500 font-medium">Show</span>
    <plg-select [options]="pageLimitOptions" [(ngModel)]="pageLimit" (ngModelChange)="onPageLimitChange()"></plg-select>
    <span class="text-gray-500 font-medium">entries</span>
  </div>

  <div class="table w-full shadow" [ngClass]="[tableContainerStyle]">
    <div class="thead" [ngStyle]="rowStyle" [ngClass]="[headerContainerStyle]">
      <div
        *ngFor="let field of fields"
        [ngClass]="headerItemStyle"
        class="th px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer"
        (click)="onHeaderSortClick(field)"
      >
        <div>
          {{ field.label }}
          <span class="ml-1 cursor-pointer" *ngIf="field.sortable"
            ><fa-icon [icon]="sortIcon" *ngIf="field.label !== activeSortField" class="text-sm"></fa-icon>
            <fa-icon
              [icon]="sortUpIcon"
              *ngIf="field.label === activeSortField && isAscending"
              class="text-green-400 text-sm"
            ></fa-icon>
            <fa-icon
              [icon]="sortDownIcon"
              *ngIf="field.label === activeSortField && !isAscending"
              class="text-green-400 text-sm"
            ></fa-icon>
          </span>
        </div>
      </div>
      <div
        class="th flex justify-end items-center px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
        *ngIf="(buttons && buttons.length > 0) || actionsTemplate"
      >
        {{ actionHeaderText }}

        <div class="flex flex-row justify-end" *ngIf="sortOptions && sortOptions.length > 0">
          <div class="text-gray-500">Sort By:</div>
          <div>
            <select
              name="sort"
              id="sortSelector"
              class="bg-gray-50 text-gray-500 pl-1 pr-3"
              (change)="onSortOptionChange($event)"
            >
              <option *ngFor="let option of sortOptions" [value]="option.value">{{ option.label }}</option>
            </select>
          </div>
        </div>
      </div>
    </div>
    <div class="tbody bg-white divide-y divide-gray-200 w-full">
      <div
        class="tr"
        *ngFor="let item of data"
        [ngStyle]="rowStyle"
        [ngClass]="[tableRowStyle]"
        (click)="onRowClick(item)"
      >
        <div
          class="td flex items-center px-6 py-4 whitespace-normal text-sm text-gray-500"
          *ngFor="let field of fields"
          [ngClass]="dataItemStyle"
        >
          <div [innerHtml]="item[field.key]" class="text-inherit"></div>
        </div>
        <div class="td px-6 py-4" *ngIf="buttons && buttons.length > 0">
          <div class="flex flex-row justify-end items-center">
            <div *ngFor="let button of buttons" class="flex items-center">
              <plg-button
                *ngIf="!button.isActionSelector"
                [fill]="button.fill"
                (hasClicked)="button.action && button.action(item)"
                [role]="button.role"
                class="ml-2"
                size="small"
                [icon]="button.icon"
                [ngClass]="!button.fill ? 'bg-none' : ''"
                [buttonStyle]="button.buttonStyle || ''"
                >{{ button.text }}</plg-button
              >

              <plg-action-selector
                *ngIf="button.isActionSelector"
                [options]="button.actionOptions"
                [context]="item"
              ></plg-action-selector>
            </div>
          </div>
        </div>
        <div class="td px-6 py-4 flex flex-row justify-end items-center empty:hidden" *ngIf="actionsTemplate">
          <ng-container>
            <ng-container *ngTemplateOutlet="actionsTemplate; context: { data: item }"> </ng-container>
          </ng-container>
        </div>
      </div>
      <div class="tr" *ngIf="data && data.length < 1" id="noDataAvailable">
        <div class="td text-center py-3 text-sm text-gray-400 uppercase" id="noDataMsg">
          {{ noDataMsg }}
        </div>
      </div>
    </div>
  </div>

  <div class="mt-20 flex justify-center" *ngIf="data && data.length > 0 && showPagination">
    <plg-table-pagination
      [pages]="pages"
      (hasPageClicked)="onPageClick($event)"
      [isInfinite]="isInfinitePagination"
      [isLastPage]="isLastPage"
    ></plg-table-pagination>
  </div>
</div>

<div class="flex flex-col">
  <div class="inline-flex flex-row items-center gap-1" *ngIf="showPageLimit">
    <span class="text-gray-500 font-medium">Show</span>
    <plg-select [options]="pageLimitOptions" [(ngModel)]="pageLimit" (ngModelChange)="onPageLimitChange()"></plg-select>
    <span class="text-gray-500 font-medium">entries</span>
  </div>

  <div class="flex-col">
    <div class="-my-2 overflow-x-auto">
      <div class="py-2 align-middle inline-block min-w-full">
        <div class="shadow overflow-hidden border-b border-gray-200" [ngClass]="[tableContainerStyle]">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50" [ngClass]="headerContainerStyle">
              <tr>
                <th
                  *ngFor="let field of fields"
                  scope="col"
                  [ngClass]="headerItemStyle"
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer py-3 px-6"
                  (click)="onHeaderSortClick(field)"
                >
                  {{ field.label }}
                  <span class="ml-1 cursor-pointer" *ngIf="field.sortable"
                    ><fa-icon [icon]="sortIcon" *ngIf="field.label !== activeSortField" class="text-sm"></fa-icon>
                    <fa-icon
                      [icon]="sortUpIcon"
                      *ngIf="field.label === activeSortField && isAscending"
                      class="text-green-400 text-sm"
                    ></fa-icon>
                    <fa-icon
                      [icon]="sortDownIcon"
                      *ngIf="field.label === activeSortField && !isAscending"
                      class="text-green-400 text-sm"
                    ></fa-icon>
                  </span>
                </th>
                <th
                  scope="col"
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                  *ngIf="(buttons && buttons.length > 0) || actionsTemplate"
                >
                  {{ actionHeaderText }}
                </th>

                <th class="px-6 py-3 text-xs" *ngIf="sortOptions && sortOptions.length > 0">
                  <div class="flex flex-row justify-end">
                    <div class="text-gray-500">Sort By:</div>
                    <div>
                      <select
                        name="sort"
                        id="sortSelector"
                        class="bg-gray-50 text-gray-500 pl-1 pr-3"
                        (change)="onSortOptionChange($event)"
                      >
                        <option *ngFor="let option of sortOptions" [value]="option.value">{{ option.label }}</option>
                      </select>
                    </div>
                  </div>
                </th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
              <tr *ngFor="let item of data">
                <td
                  class="px-6 py-4 whitespace-normal text-sm text-gray-500"
                  [ngClass]="dataItemStyle"
                  *ngFor="let field of fields"
                >
                  <div [innerHtml]="item[field.key]"></div>
                </td>
                <td *ngIf="buttons && buttons.length > 0">
                  <div class="flex flex-row justify-end items-center">
                    <div *ngFor="let button of buttons" class="flex items-center">
                      <plg-button
                        *ngIf="!button.isActionSelector"
                        [fill]="button.fill"
                        (onClick)="button.action && button.action(item)"
                        [role]="button.role"
                        class="ml-2"
                        size="small"
                        [icon]="button.icon"
                        [ngClass]="!button.fill ? 'bg-none' : ''"
                        [buttonStyle]="button.buttonStyle || ''"
                        >View Details</plg-button
                      >

                      <plg-action-selector
                        *ngIf="button.isActionSelector"
                        [options]="button.actionOptions"
                        [context]="item"
                      ></plg-action-selector>
                    </div>
                  </div>
                </td>

                <td class="flex justify-end">
                  <ng-container *ngIf="actionsTemplate">
                    <ng-container *ngTemplateOutlet="actionsTemplate; context: { data: item }"> </ng-container>
                  </ng-container>
                </td>
              </tr>
            </tbody>
            <tr *ngIf="data && data.length < 1" id="noDataAvailable">
              <td class="text-center py-3 text-sm text-gray-400 uppercase" [colSpan]="fields.length + 1" id="noDataMsg">
                {{ noDataMsg }}
              </td>
            </tr>
          </table>
        </div>
      </div>
    </div>
  </div>

  <div class="mt-20 flex justify-center" *ngIf="data && data.length > 0 && showPagination">
    <plg-table-pagination
      [pages]="pages"
      (hasPageClicked)="onPageClick($event)"
      [isInfinite]="isInfinitePagination"
      [isLastPage]="isLastPage"
    ></plg-table-pagination>
  </div>
</div>
